<html>
    <head>
        <title>YAVM - Yet Another Virtual Machine</title>
        <meta charset="utf-8" />

        <style type="text/css">
            html {
                background-color: #EFEFEF;
            }

            body {
                background-color: white;
                width: 90%;
                padding: 25px;
                margin-left: auto;
                margin-right: auto;
                margin-top: 25px;
                margin-bottom: 25px;
                border-radius: 2px;
                box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.24);
            }

            h1 {
                text-align: center;
            }

            pre, code {
                background-color: #EFEFEF;
                color: red;
            }

            pre.code {
                margin-left: 15px;
                padding: 5px;
                border-radius: 2px;
                box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.24);
            }

            table {
                border-collapse: collapse;
                text-align: center;
                border-radius: 2px;
                box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.24);1
            }

            th, td {
                border: 1px solid rgba(0, 0, 0, 0.12);
                padding: 10px;
            }
        </style>
    </head>
    <body>
        <h1>Yet Another Virtual Machine</h1>

        <p>This project provides 3 features:</p>

        <ul>
            <li>an assembly language</li>
            <li>a compiler</li>
            <li>an interpreter</li>
        </ul>

        <p>Each instruction uses the stack:</p>

        <ul>
            <li>instruction parameters are pushed onto the stack</li>
            <li>parameters are poped from the stack</li>
            <li>result is then pushed on the stack</li>
        </ul>

        <p><b>NB:</b> each instruction can have inline parameters, to avoid pushing
        on the stack.</p>

        <pre class="code">PUSH8 42
NOT8
PUSH8 1
INT</pre>

        <p>The above code push 42 on the stack, then apply a binary not on this
        value, and calls the interuption number 1 (interuptions are special
        functions built in the interpreter), which prints the stack head.</p>

        <p>It is translated in the following byte array:</p>
        <table>
            <tr>
                <td>PUSH8</td>
                <td>42</td>
                <td>NOT8</td>
                <td>PUSH8</td>
                <td>1</td>
                <td>INT</td>
            </tr>
        </table>

        <p>Each instruction is translated into a single byte:</p>

        <table>
            <tr><th>1 bit</th><th>5 bits</th><th>2 bits</th></tr>
            <tr><td>has operand</td><td>opcode</td><td>size</td></tr>
        </table>

        <p>If the flag <code>has operand</code> is set, the parameters are stored
        in the following bytes, if it is not set, the parameters are stored on
        the stack.</p>

        <p>The <code>opcode</code> bits identifies the instruction.</p>

        <p>The <code>size</code> bits identifies the size of the parameters/result:</p>

        <table>
            <tr>
                <th>Value</th>
                <th>Size</th>
            </tr>
            <tr>
                <td>00</td>
                <td>8 bits</td>
            </tr>
            <tr>
                <td>01</td>
                <td>16 bits</td>
            </tr>
            <tr>
                <td>10</td>
                <td>32 bits</td>
            </tr>
            <tr>
                <td>11</td>
                <td>64 bits</td>
            </tr>
        </table>

        <p>For the complete list of instructions and what they do:</p>

        <ul>
            <li><a href="stack.html">4 instructions for manipulating the stack</a></li>
            <li><a href="binary.html">10 instructions for binary arithmetic</a></li>
            <li><a href="integer.html">8 instructions for integer arithmetic</a></li>
            <li><a href="fixed-point.html">7 instructions for fixed point arithmetic</a></li>
            <li><a href="comparison.html">1 instruction for comparison</a></li>
            <li><a href="jump.html">4 instructions for jumping</a></li>
            <li><a href="function-call.html">4 instructions dedicated to function calls</a></li>
        </ul>
    </body>
</html>
